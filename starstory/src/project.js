require=function i(t,o,e){function n(h,a){if(!o[h]){if(!t[h]){var c="function"==typeof require&&require;if(!a&&c)return c(h,!0);if(s)return s(h,!0);var l=new Error("Cannot find module '"+h+"'");throw l.code="MODULE_NOT_FOUND",l}var r=o[h]={exports:{}};t[h][0].call(r.exports,function(i){var o=t[h][1][i];return n(o?o:i)},r,r.exports,i,t,o,e)}return o[h].exports}for(var s="function"==typeof require&&require,h=0;h<e.length;h++)n(e[h]);return n}({Global:[function(i,t,o){"use strict";cc._RFpush(t,"79171eNxxRIYJY3J5v+8vUo","Global"),t.exports={bgmName:"",starX:0,starY:0,faceDir:-1,canvas:null,star:null,balls:null,balloons:null,editor:null},cc._RFpop()},{}],balloons:[function(i,t,o){"use strict";cc._RFpush(t,"c25f9+/kIlEfoKOr3FZpwXl","balloons");var e=i("Global");cc.Class({"extends":cc.Component,properties:{balloonPrefab:{"default":null,type:cc.Prefab}},onLoad:function(){e.balloons=this.node},spawnNewBalloon:function(i,t){var o=cc.instantiate(this.balloonPrefab);o.getComponent("balloon").owner=i,o.getComponent("balloon").string=t,o.getComponent("balloon").updateText(),o.getComponent("balloon").updatePosition(),this.node.addChild(o)}}),cc._RFpop()},{Global:"Global"}],balloon:[function(i,t,o){"use strict";cc._RFpush(t,"3fd24WzSKtGb6KpHSKM2zaj","balloon"),cc.Class({"extends":cc.Component,properties:{owner:{"default":null,serializable:!1},string:"",text:{"default":null,type:cc.Node},arrow:{"default":null,type:cc.Node},duration:10},onLoad:function(){this.timer=0},update:function(i){if(this.updateText(),this.updatePosition(),this.timer+=i,this.timer>this.duration)return void this.node.destroy()},updatePosition:function(){var i=10;this.node.width=this.text.width+2*i,this.node.height=this.text.height+2*i,this.node.x=this.owner.node.x,this.node.y=this.owner.node.y+this.owner.node.height+this.node.height/2+20,this.arrow.y=-this.node.height/2},updateText:function(){this.text.getComponent(cc.Label).string=this.string}}),cc._RFpop()},{}],balls:[function(i,t,o){"use strict";cc._RFpush(t,"d6119K0mmtMY4X6sjW048nT","balls");var e=i("Global");cc.Class({"extends":cc.Component,properties:{ballPrefab:{"default":null,type:cc.Prefab}},onLoad:function(){e.balls=this.node},spawnNewBall:function(i){var t=cc.instantiate(this.ballPrefab);t.getComponent("ball").owner=i,t.setPosition(cc.p(i.node.x,i.node.y+i.node.height/2)),t.getComponent("ball").faceDir=i.faceDir,t.getComponent("ball").moveDir=i.faceDir,this.node.addChild(t)}}),cc._RFpop()},{Global:"Global"}],ball:[function(i,t,o){"use strict";cc._RFpush(t,"fe637SBmmFJlrsMZRPiAnuD","ball"),cc.Class({"extends":cc.Component,properties:{owner:{"default":null,serializable:!1},living:!0,faceDir:-1,moveDir:0},onLoad:function(){this.timer=0,this.duration=3},hitFinished:function(){this.node.destroy()},onCollisionEnter:function(i,t){if(this.living===!0){this.living=!1;var o=this.getComponent(cc.Animation);o.play("attack1.info.hit"),"mob"===i.node.group&&(i.getComponent("mob").hitting=!0,i.getComponent("mob").HP-=this.owner.getComponent("star").ATK,i.getComponent("mob").mainTarget=this.owner)}},update:function(i){if(this.timer>this.duration)return void this.node.destroy();this.timer+=i;var t=1-this.timer/this.duration,o=50;this.node.opacity=o+Math.floor(t*(255-o)),this.living===!0&&(1===this.moveDir?this.node.x+=10:this.moveDir===-1&&(this.node.x-=10)),this.updateDir()},updateDir:function(){0!==this.moveDir&&(this.faceDir=this.moveDir);var i=cc.flipX(!0);1===this.faceDir&&this.node.runAction(i);var t=cc.flipX(!1);this.faceDir===-1&&this.node.runAction(t)}}),cc._RFpop()},{}],bgm:[function(i,t,o){(function(o){"use strict";cc._RFpush(t,"1500b59qZ1FIoP1TfzOH7cw","bgm");var e=i("Global");cc.Class({"extends":cc.Component,properties:{bgm:{"default":null,url:cc.AudioClip},bgmName:""},onLoad:function(){""===o.bgmName?cc.audioEngine.playEffect(this.bgm,!0):e.bgmName!==this.bgmName&&(cc.audioEngine.stopAll(),cc.audioEngine.playEffect(this.bgm,!0)),e.bgmName=this.bgmName}}),cc._RFpop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{Global:"Global"}],canvas:[function(i,t,o){"use strict";cc._RFpush(t,"c9d7em9oe1DC6emF0dPxdsf","canvas");var e=i("Global");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){e.canvas=this.node}}),cc._RFpop()},{Global:"Global"}],editor:[function(i,t,o){"use strict";cc._RFpush(t,"11e005D/4hNU62O4eYwJwGx","editor");var e=i("Global");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){e.editor=this.node}}),cc._RFpop()},{Global:"Global"}],gate:[function(i,t,o){"use strict";cc._RFpush(t,"195a8a9M65Dq6GKIv4U5ojH","gate");var e=i("Global");cc.Class({"extends":cc.Component,properties:{preTouchingCount:0,nowTouchingCount:0,nowAnim:"continue",nexAnim:"continue",nextScene:"",nextX:0,nextY:0},onLoad:function(){this.node.opacity=0},update:function(i){this.updateAnim()},updateAnim:function(){var i=this.getComponent(cc.Animation);this.nowAnim!=this.nexAnim&&(i.play(this.nexAnim),this.nowAnim=this.nexAnim),0===this.preTouchingCount&&this.nowTouchingCount>0?(this.node.opacity=255,this.nexAnim="start",this.preTouchingCount=this.nowTouchingCount):this.preTouchingCount>0&&0===this.nowTouchingCount&&(this.nexAnim="exit",this.preTouchingCount=this.nowTouchingCount)},startFinished:function(){this.nexAnim="continue"},exitFinished:function(){this.node.opacity=0},onCollisionEnter:function(i,t){"star"===i.node.group&&(this.preTouchingCount=this.nowTouchingCount,this.nowTouchingCount+=1,i.node.getComponent("star").nextScene=this.nextScene,e.starX=this.nextX,e.starY=this.nextY)},onCollisionStay:function(i,t){},onCollisionExit:function(i,t){"star"===i.node.group&&(this.preTouchingCount=this.nowTouchingCount,this.nowTouchingCount-=1,i.node.getComponent("star").nextScene="")}}),cc._RFpop()},{Global:"Global"}],mobs:[function(i,t,o){"use strict";cc._RFpush(t,"e71d3z+s9dBHKHUaBm7f9PT","mobs"),cc.Class({"extends":cc.Component,properties:{mobPrefab:{"default":null,type:cc.Prefab},maxMobs:0,nowMobs:0},onLoad:function(){this.timer=0},update:function(i){this.timer+=i,this.nowMobs<this.maxMobs&&this.timer>1&&(this.timer=0,this.spawnNewMob())},spawnNewMob:function(){this.nowMobs+=1;var i=cc.instantiate(this.mobPrefab);i.getComponent("mob").mobs=this,i.getComponent("mob").faceDir=cc.random0To1()>.5?1:-1;var t=cc.random0To1()>.5?1:-1;i.setPosition(cc.p(t*cc.random0To1()*500,0)),this.node.addChild(i)},removeMob:function(){this.nowMobs-=1}}),cc._RFpop()},{}],mob:[function(i,t,o){"use strict";cc._RFpush(t,"f32c6HJCVdEi5fqCGe1ndGu","mob"),cc.Class({"extends":cc.Component,properties:{speed:cc.v2(0,0),maxSpeed:cc.v2(400,600),gravity:-2e3,drag:1500,moveDir:0,jumpSpeed:1800,nowAnim:"stand",nexAnim:"stand",faceDir:-1,HP:3,living:!0,jumping:!1,hitting:!1,mainTarget:{"default":null,serializable:!1}},onLoad:function(){this.collisionX=0,this.collisionY=0,this.prePosition=cc.v2(),this.preStep=cc.v2(),this.touchingNumber=0,this.footHoldingPlantformTag=0,this.footHoldingWallTag=0,this.timer=0},update:function(i){this.updatePosition(i),this.updateAnim(),this.updateDir(),this.checkDie(),this.timer+=i,this.timer>1&&(this.timer=0,this.changeAnimRandomly())},onCollisionEnter:function(i,t){this.touchingNumber+=1;var o=(i.world.aabb,i.world.preAabb.clone()),e=(t.world.aabb,t.world.preAabb.clone());"wall"===i.node.group&&(this.speed.x<0&&e.xMin>o.xMax?(this.node.x=i.offset.x+i.size.width/2+t.size.width/2-t.offset.x,this.collisionX=-1,this.speed.x=0):this.speed.x>0&&e.xMax<o.xMin&&(this.node.x=i.offset.x-i.size.width/2-t.size.width/2+t.offset.x,this.collisionX=1,this.speed.x=0)),"wall"===i.node.group&&(this.speed.y<0&&e.yMin>o.yMax?(this.node.y=i.offset.y+i.size.height/2+t.size.height/2-t.offset.y,this.jumping=!1,this.collisionY=-1,this.speed.y=0,this.footHoldingWallTag=i.tag):this.speed.y>0&&e.yMax<o.yMin&&(this.node.y=i.offset.y-i.size.height/2-t.size.height/2+t.offset.y,this.collisionY=1,this.speed.y=0)),"plantform"===i.node.group&&this.speed.y<0&&e.yMin>o.yMax&&(this.node.y=i.offset.y+i.size.height/2+t.size.height/2-t.offset.y,this.jumping=!1,this.collisionY=-1,this.speed.y=0,this.footHoldingPlantformTag=i.tag)},onCollisionStay:function(i,t){},onCollisionExit:function(i,t){this.touchingNumber-=1,0===this.touchingNumber&&(this.node.color=cc.Color.WHITE),"wall"===i.node.group?this.footHoldingWallTag===i.tag?(this.footHoldingWallTag=0,this.collisionY=0):0!==this.collisionX&&(this.collisionX=0):"plantform"===i.node.group&&this.footHoldingPlantformTag===i.tag&&(this.footHoldingPlantformTag=0,this.collisionY=0)},updatePosition:function(i){this.jumping&&(this.speed.y+=this.gravity*i,Math.abs(this.speed.y)>this.maxSpeed.y&&(this.speed.y=this.speed.y>0?this.maxSpeed.y:-this.maxSpeed.y)),0===this.moveDir?this.speed.x>0?(this.speed.x-=this.drag*i,this.speed.x<=0&&(this.speed.x=0)):this.speed.x<0&&(this.speed.x+=this.drag*i,this.speed.x>=0&&(this.speed.x=0)):(this.speed.x+=(this.moveDir>0?1:-1)*this.drag*i,Math.abs(this.speed.x)>this.maxSpeed.x&&(this.speed.x=this.speed.x>0?this.maxSpeed.x:-this.maxSpeed.x)),this.speed.x*this.collisionX>0&&(this.speed.x=0),this.node.x+=this.speed.x*i,this.node.y+=this.speed.y*i},updateAnim:function(){var i=this.getComponent(cc.Animation);this.nowAnim!=this.nexAnim&&(i.play(this.nexAnim),this.nowAnim=this.nexAnim),0===this.footHoldingPlantformTag&&0===this.footHoldingWallTag&&(this.jumping=!0),this.jumping?this.jumping&&(this.nexAnim="jump"):0===this.moveDir?this.nexAnim="stand":this.nexAnim="move",this.hitting&&(this.nexAnim="hit",this.stopMovingX()),this.living||(this.nexAnim="die",this.stopMovingX())},stopMovingX:function(){this.moveDir=0,this.speed.x=0},updateDir:function(){0!==this.moveDir&&(this.faceDir=this.moveDir);var i=cc.flipX(!0);1===this.faceDir&&this.node.runAction(i);var t=cc.flipX(!1);this.faceDir===-1&&this.node.runAction(t),null!==this.mainTarget&&(this.node.x<this.mainTarget.node.x?this.moveDir=1:this.moveDir=-1)},hitFinished:function(){this.hitting=!1,this.moveDir=-1},dieFinished:function(){this.node.destroy(),this.node.getParent().getComponent("mobs").removeMob()},checkDie:function(){this.HP<=0&&(this.living=!1)},changeAnimRandomly:function(){if("hit"!==this.nowAnim&&"jump"!==this.nowAnim){var i=cc.random0To1();i<.3?this.moveLeft():i>.7?this.moveStop():this.moveRight()}},moveLeft:function(){this.moveDir=-1},moveRight:function(){this.moveDir=1},moveStop:function(){this.moveDir=0,this.xSpeed=0},jump:function(){this.jumping||(this.jumping=!0)}}),cc._RFpop()},{}],npc:[function(i,t,o){"use strict";cc._RFpush(t,"d85dbmAkVlJw6LKN2UUPpQb","npc");var e=i("Global");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){this.timer=0,this.index=1,this.strings=["Welcom to Star Story!","练习操作方式：左键-左移；右键-右移；上键-跳跃；下键-互动；A键-攻击；回车键-发言","这里的一花一木皆源于 NEXON，请勿用于商业目的！","有任何疑问请联系 tiger20151010 @163.com"]},start:function(){this.balloons=e.balloons,this.say(this.strings[0])},update:function(i){this.timer+=i,this.timer>12&&(this.timer=0,this.say(this.strings[this.index]),this.index+=1,this.index>=this.strings.length&&(this.index=0))},say:function(i){this.balloons.getComponent("balloons").spawnNewBalloon(this,i)}}),cc._RFpop()},{Global:"Global"}],stage:[function(i,t,o){"use strict";cc._RFpush(t,"d421epoyAFIlI0Ir2PoRwg+","stage");var e=i("Global");cc.Class({"extends":cc.Component,properties:{foundation:{"default":null,type:cc.Node},maxHeight:0},onLoad:function(){},start:function(){this.target=e.star,this.canvas=e.canvas,this.camFollow(this.target)},camFollow:function(i){if(this.node.active=!cc.sys.isMobile,i){if(null!==e.canvas)var t=cc.follow(i,cc.rect(this.foundation.x-this.foundation.width/2+this.canvas.x,this.foundation.y-this.foundation.height/2+this.canvas.y,this.foundation.width,this.maxHeight));else var t=cc.follow(i,cc.rect(this.foundation.x-this.foundation.width/2,this.foundation.y-this.foundation.height/2,this.foundation.width,this.maxHeight));this.node.runAction(t)}}}),cc._RFpop()},{Global:"Global"}],star:[function(i,t,o){"use strict";cc._RFpush(t,"8210eyjK7lEeojxSO5vJE9F","star");var e=i("Global");cc.Class({"extends":cc.Component,properties:{speed:cc.v2(0,0),maxSpeed:cc.v2(400,600),gravity:-2e3,drag:1500,moveDir:0,jumpSpeed:1800,nowAnim:"jump",nexAnim:"jump",faceDir:-1,nextScene:"",ATK:1,living:!0,jumping:!1,hitting:!1},onLoad:function(){cc.director.getCollisionManager().enabled=!0,cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressed.bind(this),onKeyReleased:this.onKeyReleased.bind(this)},this.node),e.star=this.node,this.collisionX=0,this.collisionY=0,this.prePosition=cc.v2(),this.preStep=cc.v2(),this.touchingNumber=0,this.footHoldingPlantformTag=0,this.footHoldingWallTag=0,this.node.setPosition(cc.p(e.starX,e.starY)),this.faceDir=e.faceDir},start:function(){this.balls=e.balls,this.balloons=e.balloons,this.editor=e.editor},onDisabled:function(){cc.director.getCollisionManager().enabled=!1,cc.director.getCollisionManager().enabledDebugDraw=!1},replaceScene:function(){""!==this.nextScene&&cc.director.loadScene(this.nextScene),e.faceDir=this.faceDir},onKeyPressed:function(i,t){switch(i){case cc.KEY.left:this.moveDir=-1;break;case cc.KEY.right:this.moveDir=1;break;case cc.KEY.up:this.jumping||(this.jumping=!0,this.speed.y=this.jumpSpeed);break;case cc.KEY.down:this.replaceScene();break;case cc.KEY.a:this.attacking=1,this.moveDir=0;break;case cc.KEY.enter:this.editor.getComponent(cc.EditBox).setFocus()}},onKeyReleased:function(i,t){switch(i){case cc.KEY.left:case cc.KEY.right:this.moveDir=0;break;case cc.KEY.a:this.attacking=0}},onCollisionEnter:function(i,t){this.touchingNumber+=1;var o=(i.world.aabb,i.world.preAabb.clone()),e=(t.world.aabb,t.world.preAabb.clone());"wall"===i.node.group&&(this.speed.x<0&&e.xMin>o.xMax?(this.node.x=i.offset.x+i.size.width/2+t.size.width/2-t.offset.x,this.collisionX=-1,this.speed.x=0):this.speed.x>0&&e.xMax<o.xMin&&(this.node.x=i.offset.x-i.size.width/2-t.size.width/2+t.offset.x,this.collisionX=1,this.speed.x=0)),"wall"===i.node.group&&(this.speed.y<0&&e.yMin>o.yMax?(this.node.y=i.offset.y+i.size.height/2+t.size.height/2-t.offset.y,this.jumping=!1,this.collisionY=-1,this.speed.y=0,this.footHoldingWallTag=i.tag):this.speed.y>0&&e.yMax<o.yMin&&(this.node.y=i.offset.y-i.size.height/2-t.size.height/2+t.offset.y,this.collisionY=1,this.speed.y=0)),"plantform"===i.node.group&&this.speed.y<0&&e.yMin>o.yMax&&(this.node.y=i.offset.y+i.size.height/2+t.size.height/2-t.offset.y,this.jumping=!1,this.collisionY=-1,this.speed.y=0,this.footHoldingPlantformTag=i.tag)},onCollisionStay:function(i,t){},onCollisionExit:function(i,t){this.touchingNumber-=1,0===this.touchingNumber&&(this.node.color=cc.Color.WHITE),"wall"===i.node.group?this.footHoldingWallTag===i.tag?(this.footHoldingWallTag=0,this.collisionY=0):0!==this.collisionX&&(this.collisionX=0):"plantform"===i.node.group&&this.footHoldingPlantformTag===i.tag&&(this.footHoldingPlantformTag=0,this.collisionY=0)},update:function(i){this.updatePosition(i),this.updateAnim(),this.updateDir()},updatePosition:function(i){this.jumping&&(this.speed.y+=this.gravity*i,Math.abs(this.speed.y)>this.maxSpeed.y&&(this.speed.y=this.speed.y>0?this.maxSpeed.y:-this.maxSpeed.y)),0===this.moveDir?this.speed.x>0?(this.speed.x-=this.drag*i,this.speed.x<=0&&(this.speed.x=0)):this.speed.x<0&&(this.speed.x+=this.drag*i,this.speed.x>=0&&(this.speed.x=0)):(this.speed.x+=(this.moveDir>0?1:-1)*this.drag*i,Math.abs(this.speed.x)>this.maxSpeed.x&&(this.speed.x=this.speed.x>0?this.maxSpeed.x:-this.maxSpeed.x)),this.speed.x*this.collisionX>0&&(this.speed.x=0),this.node.x+=this.speed.x*i,this.node.y+=this.speed.y*i},updateAnim:function(){var i=this.getComponent(cc.Animation);if(this.nowAnim!=this.nexAnim&&(i.play(this.nexAnim),this.nowAnim=this.nexAnim),0===this.footHoldingPlantformTag&&0===this.footHoldingWallTag&&(this.jumping=!0),this.jumping?this.jumping&&(this.nexAnim="jump"):0===this.moveDir?this.nexAnim="stand":this.nexAnim="move",0!==this.attacking)switch(this.attacking){case 1:this.nexAnim="attack1"}this.hitting&&(this.nexAnim="hit",this.stopMovingX()),this.living||(this.nexAnim="die",this.stopMovingX())},stopMovingX:function(){this.moveDir=0,this.speed.x=0},updateDir:function(){0!==this.moveDir&&(this.faceDir=this.moveDir);var i=cc.flipX(!0);1===this.faceDir&&this.node.runAction(i);var t=cc.flipX(!1);this.faceDir===-1&&this.node.runAction(t)},attak1ThrowBall:function(){e.balls.getComponent("balls").spawnNewBall(this)},say:function(){this.balloons.getComponent("balloons").spawnNewBalloon(this,this.editor.getComponent(cc.EditBox).string),this.editor.getComponent(cc.EditBox).string=""}}),cc._RFpop()},{Global:"Global"}]},{},["editor","bgm","gate","balloon","Global","star","balloons","canvas","stage","balls","npc","mobs","mob","ball"]);